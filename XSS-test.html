<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS å®‰å…¨æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-case { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .test-input { width: 100%; padding: 8px; margin: 5px 0; }
        .test-button { padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px; }
        .safe { background: #d4edda; color: #155724; }
        .danger { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ›¡ï¸ XSS å®‰å…¨é˜²è­·æ¸¬è©¦</h1>
    <p>æ­¤é é¢ç”¨æ–¼æ¸¬è©¦èŠå¤©ç³»çµ±çš„XSSé˜²è­·åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>

    <div class="test-case">
        <h3>æ¸¬è©¦æ¡ˆä¾‹ 1: åŸºæœ¬ Script æ¨™ç±¤</h3>
        <input type="text" class="test-input" value="&lt;script&gt;alert('XSSæ”»æ“Š!')&lt;/script&gt;" readonly>
        <button class="test-button" onclick="testXSS(this, '&lt;script&gt;alert(\'XSSæ”»æ“Š!\')&lt;/script&gt;')">æ¸¬è©¦</button>
        <div class="result" style="display: none;"></div>
    </div>

    <div class="test-case">
        <h3>æ¸¬è©¦æ¡ˆä¾‹ 2: IMG æ¨™ç±¤ XSS</h3>
        <input type="text" class="test-input" value="&lt;img src=x onerror=alert('IMG XSS')&gt;" readonly>
        <button class="test-button" onclick="testXSS(this, '&lt;img src=x onerror=alert(\'IMG XSS\')&gt;')">æ¸¬è©¦</button>
        <div class="result" style="display: none;"></div>
    </div>

    <div class="test-case">
        <h3>æ¸¬è©¦æ¡ˆä¾‹ 3: HTML å¯¦é«”ç·¨ç¢¼</h3>
        <input type="text" class="test-input" value="&amp;lt;script&amp;gt;alert('ç·¨ç¢¼XSS')&amp;lt;/script&amp;gt;" readonly>
        <button class="test-button" onclick="testXSS(this, '&amp;lt;script&amp;gt;alert(\'ç·¨ç¢¼XSS\')&amp;lt;/script&amp;gt;')">æ¸¬è©¦</button>
        <div class="result" style="display: none;"></div>
    </div>

    <div class="test-case">
        <h3>æ¸¬è©¦æ¡ˆä¾‹ 4: æ­£å¸¸æ–‡å­—</h3>
        <input type="text" class="test-input" value="é€™æ˜¯æ­£å¸¸çš„èŠå¤©æ¶ˆæ¯ï¼ŒåŒ…å«<b>HTML</b>æ¨™ç±¤" readonly>
        <button class="test-button" onclick="testXSS(this, 'é€™æ˜¯æ­£å¸¸çš„èŠå¤©æ¶ˆæ¯ï¼ŒåŒ…å«&lt;b&gt;HTML&lt;/b&gt;æ¨™ç±¤')">æ¸¬è©¦</button>
        <div class="result" style="display: none;"></div>
    </div>

    <script>
        // è¤‡è£½æˆ‘å€‘çš„å®‰å…¨å‡½æ•¸
        function sanitizeContent(content) {
            if (typeof content !== 'string') {
                content = String(content);
            }
            
            // ç§»é™¤æ‰€æœ‰ HTML æ¨™ç±¤ï¼Œåªä¿ç•™ç´”æ–‡å­—
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            return tempDiv.textContent || tempDiv.innerText || '';
        }

        function testXSS(button, testContent) {
            const resultDiv = button.nextElementSibling;
            resultDiv.style.display = 'block';
            
            try {
                // æ¸¬è©¦æˆ‘å€‘çš„æ¸…ç†å‡½æ•¸
                const cleanedContent = sanitizeContent(testContent);
                
                // æª¢æŸ¥æ˜¯å¦åŒ…å«å±éšªå…§å®¹
                const hasDangerousContent = testContent.includes('<script>') || 
                                          testContent.includes('onerror') || 
                                          testContent.includes('javascript:');
                
                // æª¢æŸ¥æ¸…ç†å¾Œæ˜¯å¦å®‰å…¨
                const isCleanedSafe = !cleanedContent.includes('<') && 
                                     !cleanedContent.includes('>') && 
                                     !cleanedContent.includes('javascript:');
                
                if (hasDangerousContent && isCleanedSafe) {
                    resultDiv.className = 'result safe';
                    resultDiv.innerHTML = `
                        <strong>âœ… å®‰å…¨é˜²è­·æˆåŠŸ!</strong><br>
                        åŸå§‹å…§å®¹: ${testContent}<br>
                        æ¸…ç†å¾Œ: ${cleanedContent}
                    `;
                } else if (!hasDangerousContent) {
                    resultDiv.className = 'result safe';
                    resultDiv.innerHTML = `
                        <strong>âœ… æ­£å¸¸å…§å®¹è™•ç†æˆåŠŸ!</strong><br>
                        æ¸…ç†å¾Œ: ${cleanedContent}
                    `;
                } else {
                    resultDiv.className = 'result danger';
                    resultDiv.innerHTML = `
                        <strong>âŒ é˜²è­·å¯èƒ½æœ‰å•é¡Œ!</strong><br>
                        æ¸…ç†å¾Œä»åŒ…å«å±éšªå…§å®¹: ${cleanedContent}
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result danger';
                resultDiv.innerHTML = `<strong>âŒ æ¸¬è©¦å‡ºéŒ¯:</strong> ${error.message}`;
            }
        }

        // é é¢è¼‰å…¥å¾Œè‡ªå‹•é‹è¡Œæ‰€æœ‰æ¸¬è©¦
        window.addEventListener('load', function() {
            setTimeout(() => {
                const buttons = document.querySelectorAll('.test-button');
                buttons.forEach(button => button.click());
            }, 1000);
        });
    </script>
</body>
</html> 